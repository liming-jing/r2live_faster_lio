<launch>

    <arg name="config_path" default = "$(find r2live)/../config/filr_m2dgr_cam.yaml" />
	<arg name="vins_path" default = "$(find r2live)/../config/../" />

    
    <node pkg="image_transport" type="republish" name="republish" args="compressed in:=/camera/color/image_raw raw out:=/camera/color/image_raw" output="screen" respawn="true"/>

    <node name="feature_tracker" pkg="feature_tracker" type="feature_tracker" output="log">
        <param name="config_file" type="string" value="$(arg config_path)" />
        <param name="vins_folder" type="string" value="$(arg vins_path)" />
        <param name="image_topic" type="string" value="/camera/color/image_raw"/>
    </node>

    <node pkg="r2live" type="lio_feat_extract" name="lio_feat_extract"  output="log">
        <rosparam command="load" file="$(find r2live)/../config/lio_m2dgr_config.yaml" />
    </node>
    
    <!-- 注意imu的topic -->
    <group if="1">
        <node name="r2live" pkg="r2live" type="r2live" output="screen">
                <param name="config_file" type="string" value="$(arg config_path)" />
                <param name="vins_folder" type="string" value="$(arg vins_path)" />
                <param name="imu_topic" type="string" value="/handsfree/imu"/>  
                <rosparam command="load" file="$(find r2live)/../config/r2live.yaml" />
                <rosparam command="load" file="$(find r2live)/../config/lio_m2dgr_config.yaml" />
        </node> 
    </group>
        
    <arg name="rviz" default="1" />
    <group if="$(arg rviz)">
        <node name="rvizvisualisation" pkg="rviz" type="rviz" output="log" args="-d $(find r2live)/../config/rviz/vins_rviz_config.rviz" />
    </group>
    
</launch>